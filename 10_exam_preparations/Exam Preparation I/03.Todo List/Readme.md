Archive.zip contains the different, but still working solution without error handing and that meets only the requests in the problem.

Archive2.zip contains a solution with added error handling.